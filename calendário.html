<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>EstudArt - Calendário, Notas e Metas</title>
<style>
  * {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f0f4ff;
    color: #222;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  header {
    background: #3b5bdb;
    padding: 16px 24px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    box-shadow: 0 3px 10px rgba(59,91,219,0.3);
  }

  .logo {
    font-weight: 900;
    font-size: 1.8rem;
    color: #e0e7ff;
    letter-spacing: 2px;
  }

  nav a {
    color: #dbe4ff;
    text-decoration: none;
    font-weight: 600;
    margin-left: 24px;
    transition: color 0.3s ease;
  }

  nav a:hover {
    color: #fff;
  }

  main {
    max-width: 1200px;
    width: 100%;
    margin: 40px auto 60px;
    padding: 0 20px;
    flex-grow: 1;
    display: flex;
    flex-wrap: wrap;
    gap: 30px;
  }

  .calendar-container {
    background: #fff;
    border-radius: 14px;
    box-shadow: 0 8px 28px rgba(59, 91, 219, 0.12);
    padding: 24px;
    flex: 2 1 600px;
    display: flex;
    flex-direction: column;
    min-width: 300px;
  }

  .calendar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 18px;
  }

  .calendar-header button {
    background: #3b5bdb;
    border: none;
    color: white;
    font-size: 1.2rem;
    padding: 8px 16px;
    border-radius: 10px;
    cursor: pointer;
    transition: background 0.3s ease;
  }

  .calendar-header button:hover {
    background: #2245a8;
  }

  .month-year {
    font-weight: 700;
    font-size: 1.5rem;
    color: #2245a8;
    text-align: center;
  }

  .calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 8px;
  }

  .calendar-day-name {
    font-weight: 700;
    color: #3b5bdb;
    text-align: center;
    padding-bottom: 6px;
    border-bottom: 2px solid #3b5bdb;
  }

  .calendar-cell {
    min-height: 80px;
    background: #f9fbff;
    border-radius: 10px;
    padding: 6px;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    transition: background 0.2s ease;
    position: relative;
  }

  .calendar-cell:hover {
    background: #dbe4ff;
  }

  .calendar-cell.inactive {
    color: #a0a8c0;
    background: transparent;
    cursor: default;
  }

  .calendar-cell .date-number {
    font-weight: 700;
    font-size: 1.1rem;
    margin-bottom: 4px;
    color: #2245a8;
  }

  .calendar-cell .note-dot {
    width: 8px;
    height: 8px;
    background: #3b5bdb;
    border-radius: 50%;
    position: absolute;
    bottom: 6px;
    right: 6px;
  }

  .side-panel {
    flex: 1 1 300px;
    display: flex;
    flex-direction: column;
    gap: 30px;
  }

  .side-card {
    background: #fff;
    border-radius: 14px;
    box-shadow: 0 8px 28px rgba(59, 91, 219, 0.12);
    padding: 24px;
    display: flex;
    flex-direction: column;
  }

  .side-card h2 {
    margin-top: 0;
    margin-bottom: 16px;
    color: #2245a8;
  }

  textarea {
    width: 100%;
    min-height: 150px;
    resize: vertical;
    border-radius: 10px;
    border: 1.5px solid #3b5bdb;
    padding: 12px;
    font-family: inherit;
    font-size: 1rem;
    color: #222;
    background: #f0f4ff;
    transition: border-color 0.3s ease;
  }

  textarea:focus {
    border-color: #2245a8;
    outline: none;
  }

  .goals-list {
    list-style: none;
    padding: 0;
    margin: 0;
    max-height: 200px;
    overflow-y: auto;
  }

  .goal-item {
    background: #f0f4ff;
    margin-bottom: 10px;
    padding: 10px 14px;
    border-radius: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: #2245a8;
    font-weight: 600;
  }

  .goal-item button {
    background: transparent;
    border: none;
    color: #bb2f2f;
    font-size: 1.2rem;
    cursor: pointer;
    transition: color 0.3s ease;
  }

  .goal-item button:hover {
    color: #8a0000;
  }

  .add-goal-form {
    margin-top: 12px;
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }

  .add-goal-form input {
    flex: 1 1 70%;
    padding: 8px 12px;
    border-radius: 10px;
    border: 1.5px solid #3b5bdb;
    font-size: 1rem;
  }

  .add-goal-form button {
    background: #3b5bdb;
    border: none;
    color: white;
    padding: 8px 16px;
    font-weight: 700;
    border-radius: 10px;
    cursor: pointer;
  }

  .add-goal-form button:hover {
    background: #2245a8;
  }

  /* Modal */
  .modal-bg {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.35);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    padding: 20px;
  }

  .modal-bg.active {
    display: flex;
  }

  .modal {
    background: #fff;
    border-radius: 14px;
    box-shadow: 0 8px 28px rgba(59, 91, 219, 0.25);
    max-width: 500px;
    width: 100%;
    padding: 24px;
    display: flex;
    flex-direction: column;
  }

  .modal h3 {
    margin: 0 0 12px;
    color: #2245a8;
  }

  .modal-buttons {
    margin-top: 16px;
    display: flex;
    justify-content: flex-end;
    gap: 12px;
  }

  .modal-buttons button {
    padding: 8px 16px;
    border-radius: 10px;
    font-weight: 700;
    border: none;
    cursor: pointer;
  }

  .modal-buttons .save {
    background: #3b5bdb;
    color: white;
  }

  .modal-buttons .cancel {
    background: #e0e7ff;
    color: #2245a8;
  }

  /* Scrollbar personalizada */
  .goals-list::-webkit-scrollbar {
    width: 6px;
  }
  .goals-list::-webkit-scrollbar-thumb {
    background: #3b5bdb;
    border-radius: 10px;
  }

  /* === Responsividade === */
  @media (max-width: 768px) {
    header {
      flex-direction: column;
      gap: 10px;
      text-align: center;
    }

    nav a {
      margin: 0 10px;
      display: inline-block;
    }

    .calendar-grid {
      grid-template-columns: repeat(7, minmax(36px, 1fr));
    }

    .calendar-cell {
      min-height: 60px;
      font-size: 0.9rem;
    }

    main {
      flex-direction: column;
      gap: 20px;
      padding: 0 10px;
    }

    .side-card {
      padding: 16px;
    }

    .month-year {
      font-size: 1.2rem;
    }
  }
</style>
</head>
<body>
<header>
  <div class="logo">EstudArt</div>
  <nav>
    <a href="index.html">Início</a>
    <a href="perfil.html">Perfil</a>
  </nav>
</header>

<main>
  <section class="calendar-container">
    <div class="calendar-header">
      <button id="prevMonth">&lt;</button>
      <div class="month-year" id="monthYear"></div>
      <button id="nextMonth">&gt;</button>
    </div>
    <div class="calendar-grid" id="calendarGrid"></div>
  </section>

  <aside class="side-panel">
    <section class="side-card">
      <h2>Notas Gerais</h2>
      <textarea id="generalNotes" placeholder="Escreva suas notas aqui..."></textarea>
    </section>
    <section class="side-card">
      <h2>Metas</h2>
      <ul class="goals-list" id="goalsList"></ul>
      <form class="add-goal-form" id="addGoalForm">
        <input type="text" id="newGoalInput" placeholder="Nova meta..." />
        <button type="submit">Adicionar</button>
      </form>
    </section>
  </aside>
</main>

<div class="modal-bg" id="modal">
  <div class="modal">
    <h3>Notas para <span id="modalDate"></span></h3>
    <textarea id="dayNotes" placeholder="Escreva suas anotações..."></textarea>
    <div class="modal-buttons">
      <button class="save" id="saveDayNotesBtn">Salvar</button>
      <button class="cancel" id="cancelDayNotesBtn">Cancelar</button>
    </div>
  </div>
</div>

<script>
  // Dados guardados localmente para persistência
  const STORAGE_KEYS = {
    generalNotes: 'meusite_general_notes',
    goals: 'meusite_goals',
    dayNotes: 'meusite_day_notes', // JSON com notas do calendário, chave: "YYYY-MM-DD" : texto
  };

  // Estado atual do calendário
  let currentDate = new Date();
  let selectedDateStr = null;

  // Elements
  const monthYearEl = document.getElementById('monthYear');
  const calendarGrid = document.getElementById('calendarGrid');
  const modal = document.getElementById('modal');
  const modalDateSpan = document.getElementById('modalDate');
  const dayNotesTextarea = document.getElementById('dayNotes');
  const saveDayNotesBtn = document.getElementById('saveDayNotesBtn');
  const cancelDayNotesBtn = document.getElementById('cancelDayNotesBtn');
  const generalNotesTextarea = document.getElementById('generalNotes');
  const goalsList = document.getElementById('goalsList');
  const addGoalForm = document.getElementById('addGoalForm');
  const newGoalInput = document.getElementById('newGoalInput');

  // Função para obter nome do mês em pt-BR
  function getMonthName(monthIndex) {
    const months = ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
                    'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
    return months[monthIndex];
  }

  // Carregar notas do dia do localStorage (objeto)
  function loadDayNotes() {
    const data = localStorage.getItem(STORAGE_KEYS.dayNotes);
    return data ? JSON.parse(data) : {};
  }
  // Salvar notas do dia no localStorage
  function saveDayNotes(data) {
    localStorage.setItem(STORAGE_KEYS.dayNotes, JSON.stringify(data));
  }

  // Carregar metas do localStorage (array)
  function loadGoals() {
    const data = localStorage.getItem(STORAGE_KEYS.goals);
    return data ? JSON.parse(data) : [];
  }
  // Salvar metas no localStorage
  function saveGoals(data) {
    localStorage.setItem(STORAGE_KEYS.goals, JSON.stringify(data));
  }

  // Carregar notas gerais
  function loadGeneralNotes() {
    return localStorage.getItem(STORAGE_KEYS.generalNotes) || '';
  }
  // Salvar notas gerais
  function saveGeneralNotes(text) {
    localStorage.setItem(STORAGE_KEYS.generalNotes, text);
  }

  // Renderizar o calendário
  function renderCalendar() {
    calendarGrid.innerHTML = '';

    // Dias da semana (dom, seg, ter...)
    const weekDays = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];
    weekDays.forEach(day => {
      const dayName = document.createElement('div');
      dayName.classList.add('calendar-day-name');
      dayName.textContent = day;
      calendarGrid.appendChild(dayName);
    });

    const year = currentDate.getFullYear();
    const month = currentDate.getMonth();

    monthYearEl.textContent = `${getMonthName(month)} ${year}`;

    const firstDayOfMonth = new Date(year, month, 1);
    const lastDayOfMonth = new Date(year, month + 1, 0);
    const firstWeekDay = firstDayOfMonth.getDay();

    const daysInMonth = lastDayOfMonth.getDate();

    const dayNotes = loadDayNotes();

    // Dias anteriores para preencher grid (vazios)
    for(let i = 0; i < firstWeekDay; i++) {
      const emptyCell = document.createElement('div');
      emptyCell.classList.add('calendar-cell', 'inactive');
      calendarGrid.appendChild(emptyCell);
    }

    // Dias do mês
    for(let day = 1; day <= daysInMonth; day++) {
      const dateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(day).padStart(2,'0')}`;
      const cell = document.createElement('button');
      cell.classList.add('calendar-cell');
      cell.setAttribute('tabindex', '0');
      cell.setAttribute('aria-label', `Dia ${day} de ${getMonthName(month)} ${year}`);

      const dateNumber = document.createElement('div');
      dateNumber.classList.add('date-number');
      dateNumber.textContent = day;
      cell.appendChild(dateNumber);

      // Se tiver nota, coloca ponto
      if(dayNotes[dateStr] && dayNotes[dateStr].trim() !== '') {
        const dot = document.createElement('div');
        dot.classList.add('note-dot');
        cell.appendChild(dot);
      }

      cell.addEventListener('click', () => openDayModal(dateStr));
      calendarGrid.appendChild(cell);
    }
  }

  // Abrir modal para edição da nota do dia
  function openDayModal(dateStr) {
    selectedDateStr = dateStr;
    modalDateSpan.textContent = dateStr;
    const dayNotes = loadDayNotes();
    dayNotesTextarea.value = dayNotes[dateStr] || '';
    modal.classList.add('active');
    dayNotesTextarea.focus();
  }
  // Fechar modal
  function closeDayModal() {
    modal.classList.remove('active');
    selectedDateStr = null;
  }

  // Salvar nota do dia
  function saveDayNote() {
    if(!selectedDateStr) return;
    const dayNotes = loadDayNotes();
    const text = dayNotesTextarea.value.trim();
    if(text === '') {
      delete dayNotes[selectedDateStr];
    } else {
      dayNotes[selectedDateStr] = text;
    }
    saveDayNotes(dayNotes);
    renderCalendar();
    closeDayModal();
  }

  // Eventos modal
  saveDayNotesBtn.addEventListener('click', saveDayNote);
  cancelDayNotesBtn.addEventListener('click', closeDayModal);
  modal.addEventListener('click', e => {
    if(e.target === modal) closeDayModal();
  });

  // Navegação do calendário
  document.getElementById('prevMonth').addEventListener('click', () => {
    currentDate.setMonth(currentDate.getMonth() - 1);
    renderCalendar();
  });
  document.getElementById('nextMonth').addEventListener('click', () => {
    currentDate.setMonth(currentDate.getMonth() + 1);
    renderCalendar();
  });

  // Metas
  function renderGoals() {
    const goals = loadGoals();
    goalsList.innerHTML = '';
    if(goals.length === 0) {
      const li = document.createElement('li');
      li.textContent = 'Nenhuma meta adicionada.';
      li.style.color = '#999';
      li.style.fontStyle = 'italic';
      goalsList.appendChild(li);
      return;
    }
    goals.forEach((goal, idx) => {
      const li = document.createElement('li');
      li.classList.add('goal-item');
      li.textContent = goal;

      const btnDel = document.createElement('button');
      btnDel.setAttribute('aria-label', `Remover meta: ${goal}`);
      btnDel.innerHTML = '&times;';
      btnDel.addEventListener('click', () => {
        removeGoal(idx);
      });
      li.appendChild(btnDel);
      goalsList.appendChild(li);
    });
  }
  function addGoal(goalText) {
    if(!goalText.trim()) return;
    const goals = loadGoals();
    goals.push(goalText.trim());
    saveGoals(goals);
    renderGoals();
  }
  function removeGoal(idx) {
    const goals = loadGoals();
    goals.splice(idx, 1);
    saveGoals(goals);
    renderGoals();
  }
  addGoalForm.addEventListener('submit', e => {
    e.preventDefault();
    addGoal(newGoalInput.value);
    newGoalInput.value = '';
    newGoalInput.focus();
  });

  // Notas gerais
  generalNotesTextarea.value = loadGeneralNotes();
  generalNotesTextarea.addEventListener('input', () => {
    saveGeneralNotes(generalNotesTextarea.value);
  });

  // Inicializa calendário e metas
  renderCalendar();
  renderGoals();

  if(Notification && Notification.permission !== "granted"){
    Notification.requestPermission();
  }

  // Checa a cada segundo se o cronômetro terminou
  setInterval(() => {
    const fimSalvo = localStorage.getItem("cronometroFim");
    if(fimSalvo){
      const fim = parseInt(fimSalvo);
      const agora = Date.now();
      if(agora >= fim){
        // Remove o cronômetro salvo
        localStorage.removeItem("cronometroFim");
        localStorage.removeItem("cronometroPausado");

        // Notificação
        if(Notification.permission === "granted"){
          new Notification("⏰ Tempo encerrado!", { body: "Seu cronômetro acabou!" });
        } else {
          alert("⏰ Tempo encerrado!");
        }
      }
    }
  }, 1000);
  
</script>

<script>
document.addEventListener('contextmenu', function(e) {
  e.preventDefault();
  alert("⚠️ Clique direito desabilitado neste site!");
});
</script>
<script>
document.addEventListener('keydown', function(e) {
  if (e.ctrlKey && (e.key === 'c' || e.key === 's' || e.key === 'u')) {
    e.preventDefault();
    alert("⚠️ Esta ação não é permitida no site!");
  }
});
</script>

</body>
</html>
